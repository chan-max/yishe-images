version: '3.8'

services:
  yishe-images:
    # 镜像名称（如果已经构建）
    # image: yishe-images:latest
    # 或者使用构建配置
    build:
      context: .
      dockerfile: Dockerfile
    container_name: yishe-images
    ports:
      # 格式：宿主机端口:容器端口
      # 将容器的 1513 端口映射到宿主机的 1513 端口
      - "1513:1513"
    volumes:
      # 数据持久化：将容器内的目录挂载到宿主机
      # 这样即使容器删除，数据也不会丢失
      - ./uploads:/app/uploads
      - ./output:/app/output
      - ./template:/app/template
    environment:
      # 环境变量
      - NODE_ENV=production
      - PORT=1513
    restart: unless-stopped
    # 资源限制（可选）
    deploy:
      resources:
        limits:
          cpus: '2'
          memory: 2G
        reservations:
          cpus: '0.5'
          memory: 512M

